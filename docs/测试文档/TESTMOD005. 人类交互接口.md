# TESTMOD005. 人类交互接口

## 基本信息

### 模块ID
TESTMOD005

### 模块名
人类交互接口测试

### 模块描述
对MOD005人类交互接口模块进行测试验证，确保基于HTTP的Web接口能够正确提供RESTful API服务，实现模块的CRUD操作功能。

## 测试用例

### TESTCASE001. 获取根模块列表功能测试
- **测试用例名**: 获取根模块列表功能测试
- **测试目标**: MOD005.FUNC001
- **测试用例描述**: 验证get_root_modules函数能够通过GET /api/modules接口正确返回根模块列表
- **测试步骤**:
  1. 发送GET请求到/api/modules接口
  2. 验证响应状态码为200
  3. 验证响应格式包含success、data、message字段
  4. 验证data字段为Module数组类型
  5. 验证返回的根模块列表正确（parent字段为空）
  6. 验证缓存机制正常工作
  7. 验证空列表情况下的正确响应
- **测试结果**:
  - 预期结果1：接口返回状态码200
  - 预期结果2：响应格式符合APIResponse规范
  - 预期结果3：返回的根模块列表准确
  - 预期结果4：缓存机制提高响应速度
  - 预期结果5：空列表返回正确格式

### TESTCASE002. 按层次名称获取模块信息功能测试
- **测试用例名**: 按层次名称获取模块信息功能测试
- **测试目标**: MOD005.FUNC002
- **测试用例描述**: 验证get_module_by_hierarchical_name函数能够通过GET /api/modules/{hierarchical_name}接口正确返回指定模块信息
- **测试步骤**:
  1. 发送GET请求到/api/modules/ExistingModule接口
  2. 验证响应状态码为200
  3. 验证返回的模块信息包含正确字段
  4. 测试不存在的模块：发送GET请求到/api/modules/NonExistentModule
  5. 验证响应状态码为404
  6. 验证错误信息清晰准确
  7. 测试无效的层次名称格式：发送GET请求到/api/modules/invalid@name
  8. 验证响应状态码为400
- **测试结果**:
  - 预期结果1：存在模块返回状态码200和正确信息
  - 预期结果2：不存在模块返回状态码404
  - 预期结果3：错误信息清晰说明模块未找到
  - 预期结果4：无效格式返回状态码400

### TESTCASE003. 关键词搜索模块功能测试
- **测试用例名**: 关键词搜索模块功能测试
- **测试目标**: MOD005.FUNC003
- **测试用例描述**: 验证search_modules函数能够通过GET /api/modules/search接口正确执行关键词搜索
- **测试步骤**:
  1. 发送GET请求到/api/modules/search?keyword=test接口
  2. 验证响应状态码为200
  3. 验证返回的搜索结果包含匹配模块
  4. 测试类型筛选：发送GET请求到/api/modules/search?keyword=test&type=class
  5. 验证返回结果仅包含class类型模块
  6. 测试分页参数：发送GET请求到/api/modules/search?keyword=test&limit=5&offset=10
  7. 验证返回结果数量限制正确
  8. 测试空关键词：发送GET请求到/api/modules/search?keyword=
  9. 验证响应状态码为400
  10. 测试缓存机制：重复相同搜索请求
  11. 验证第二次响应更快
- **测试结果**:
  - 预期结果1：关键词搜索返回匹配结果
  - 预期结果2：类型筛选功能正常工作
  - 预期结果3：分页参数正确应用
  预期结果4：空关键词返回400错误
  - 预期结果5：缓存机制提高性能

### TESTCASE004. 添加新模块功能测试
- **测试用例名**: 添加新模块功能测试
- **测试目标**: MOD005.FUNC004
- **测试用例描述**: 验证add_module函数能够通过POST /api/modules接口正确添加新模块
- **测试步骤**:
  1. 发送POST请求到/api/modules接口：
     - 请求体：{"name":"NewTestModule","type":"class","description":"测试添加的模块"}
  2. 验证响应状态码为201
  3. 验证返回的新模块信息正确
  4. 测试重复模块名称：发送相同请求
  5. 验证响应状态码为409
  6. 测试无效参数：发送缺少必需字段的请求
  7. 验证响应状态码为400
  8. 测试父模块不存在：发送包含无效parent的请求
  9. 验证响应状态码为400
- **测试结果**:
  - 预期结果1：成功添加返回状态码201
  - 预期结果2：返回的新模块信息完整准确
  - 预期结果3：重复名称返回409冲突错误
  - 预期结果4：无效参数返回400错误
  - 预期结果5：父模块不存在返回400错误

### TESTCASE005. 修改模块信息功能测试
- **测试用例名**: 修改模块信息功能测试
- **测试目标**: MOD005.FUNC005
- **测试用例描述**: 验证update_module函数能够通过PUT /api/modules/{hierarchical_name}接口正确更新模块信息
- **测试步骤**:
  1. 发送PUT请求到/api/modules/ExistingModule接口：
     - 请求体：{"description":"更新后的描述","content":"更新后的内容"}
  2. 验证响应状态码为200
  3. 验证返回的更新后模块信息正确
  4. 测试不存在的模块：发送PUT请求到/api/modules/NonExistentModule
  5. 验证响应状态码为404
  6. 测试无效更新数据：发送包含无效字段的请求
  7. 验证响应状态码为400
  8. 测试父模块循环引用：发送parent指向自身的请求
  9. 验证响应状态码为400
- **测试结果**:
  - 预期结果1：成功更新返回状态码200
  - 预期结果2：返回的更新后信息正确
  - 预期结果3：不存在模块返回404错误
  - 预期结果4：无效数据返回400错误
  - 预期结果5：循环引用返回400错误

### TESTCASE006. 删除模块功能测试
- **测试用例名**: 删除模块功能测试
- **测试目标**: MOD005.FUNC006
- **测试用例描述**: 验证delete_module函数能够通过DELETE /api/modules/{hierarchical_name}接口正确删除模块
- **测试步骤**:
  1. 发送DELETE请求到/api/modules/DeletableModule接口
  2. 验证响应状态码为200
  3. 验证模块已从系统中删除
  4. 测试删除不存在的模块：发送DELETE请求到/api/modules/NonExistentModule
  5. 验证响应状态码为404
  6. 测试删除有子模块的父模块：发送DELETE请求到/api/modules/ParentWithChildren
  7. 验证响应状态码为409
  8. 测试删除被引用的模块：发送DELETE请求到/api/modules/ReferencedModule
  9. 验证响应状态码为409
  10. 测试级联删除：删除父模块后验证子模块状态
- **测试结果**:
  - 预期结果1：成功删除返回状态码200
  - 预期结果2：模块正确从系统移除
  - 预期结果3：不存在模块返回404错误
  - 预期结果4：有子模块返回409冲突错误
  - 预期结果5：被引用模块返回409冲突错误

### TESTCASE007. RESTful API完整流程测试
- **测试用例名**: RESTful API完整流程测试
- **测试目标**: MOD005整体功能
- **测试用例描述**: 验证整个RESTful API的完整工作流程，从模块创建到删除的完整生命周期
- **测试步骤**:
  1. 测试模块创建：发送POST请求添加新模块
  2. 验证创建成功，记录hierarchical_name
  3. 测试模块查询：发送GET请求获取刚创建的模块
  4. 验证查询结果与创建信息一致
  5. 测试模块更新：发送PUT请求修改模块描述
  6. 验证更新后的查询结果正确
  7. 测试模块搜索：发送GET搜索请求包含新模块
  8. 验证搜索结果包含新模块
  9. 测试模块删除：发送DELETE请求删除模块
  10. 验证删除后查询返回404
  11. 测试根模块列表：发送GET请求获取根模块列表
  12. 验证列表更新反映删除操作
- **测试结果**:
  - 预期结果1：模块创建成功并返回正确信息
  - 预期结果2：模块查询返回准确信息
  - 预期结果3：模块更新正确生效
  - 预期结果4：搜索功能正常工作
  - 预期结果5：模块删除彻底
  - 预期结果6：根模块列表实时更新